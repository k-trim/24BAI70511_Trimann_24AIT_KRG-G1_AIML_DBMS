CREATE TABLE BOOKS (
BOOK_ID INT PRIMARY KEY, 
BOOK_NAME VARCHAR(20) NOT NULL,
AUTHOR_NAME VARCHAR(20) NOT NULL
)

SELECT * FROM BOOKS

ALTER TABLE BOOKS
ADD BOOK_COUNT INT CHECK(BOOK_COUNT > 0) NOT NULL

SELECT * FROM BOOKS

INSERT INTO BOOKS VALUES(101, 'Harry Potter', 'David', 3)

CREATE TABLE LIBRARY_VISITORS (
USER_ID INT PRIMARY KEY,
NAME VARCHAR(20) NOT NULL,
AGE INT CHECK(AGE >= 17) NOT NULL,
EMAIL VARCHAR(20) NOT NULL UNIQUE
)

SELECT * FROM LIBRARY_VISITORS

INSERT INTO LIBRARY_VISITORS(USER_ID, NAME, AGE, EMAIL) 
VALUES(501, 'vansh', 19, 'vansh@gmail.com')

SELECT * FROM LIBRARY_VISITORS

CREATE TABLE BOOK_ISSUE(
BOOK_ISSUE_ID INT PRIMARY KEY,
BOOK_ID INT NOT NULL,
USER_ID INT NOT NULL,
FOREIGN KEY(USER_ID) REFERENCES LIBRARY_VISITORS(USER_ID),
FOREIGN KEY(BOOK_ID) REFERENCES BOOKS(BOOK_ID) 
)

INSERT INTO BOOK_ISSUE VALUES(10001, 101, 501)

ALTER TABLE BOOK_ISSUE
ADD ISSUE_DATE DATE


SELECT * FROM BOOK_ISSUE


UPDATE BOOK_ISSUE
SET ISSUE_DATE='2026-01-08'
WHERE BOOK_ID=101

SELECT * FROM BOOK_ISSUE


CREATE ROLE LIBRARIAN 
WITH LOGIN PASSWORD '12345678'

SELECT CURRENT_USER


GRANT SELECT, INSERT, DELETE, UPDATE ON BOOKS TO LIBRARIAN
GRANT SELECT, INSERT, DELETE, UPDATE ON BOOK_ISSUE TO LIBRARIAN
GRANT SELECT, INSERT, DELETE, UPDATE ON LIBRARY_VISITORS TO LIBRARIAN



-- LIBRARIAN
SELECT * FROM BOOKS
SELECT * FROM BOOK_ISSUE
SELECT * FROM LIBRARY_VISITORS


REVOKE SELECT, INSERT, DELETE, UPDATE ON BOOKS, BOOK_ISSUE, LIBRARY_VISITORS FROM LIBRARIAN

SELECT * FROM BOOKS


TRUNCATE TABLE BOOK_ISSUE
SELECT * FROM BOOK_ISSUE


DROP TABLE BOOK_ISSUE
SELECT * FROM BOOK_ISSUE

